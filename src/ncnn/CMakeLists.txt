CMAKE_MINIMUM_REQUIRED(VERSION 3.10)

PROJECT(OrtEngineModule)

SET(CMAKE_POSITION_INDEPENDENT_CODE ON) 

LOAD_OPENCV()
LOAD_OPENMP()
LOAD_NCNN()

SET(DEPENDENCY_INCLUDES
	${OpenCV_INCLUDE_DIRS}
	${NCNN_INCLUDE_DIR}
)

SET(DEPENDENCY_LIBS
	ai_core::ai_core
	encrypt::encrypt
	logger::logger
	${OpenMP_CXX_FLAGS}
	${NCNN_LIBS}
	${OpenCV_LIBS}
)

FILE(GLOB_RECURSE CURRENT_DIR_HEADS ${CMAKE_CURRENT_SOURCE_DIR}/*.hpp)
FILE(GLOB_RECURSE CURRENT_DIR_SRCS ${CMAKE_CURRENT_SOURCE_DIR}/*.cpp)

MESSAGE(INFO "Inference engine type is ONNXRuntime")

ADD_COMPILE_OPTIONS(-fopenmp)

ADD_LIBRARY(ai_ncnn_module
	${CURRENT_DIR_SRCS}
	${CURRENT_DIR_HEADS}
)

TARGET_INCLUDE_DIRECTORIES(ai_ncnn_module
		${DEPENDENCY_INCLUDES}
)

TARGET_LINK_LIBRARIES(ai_ncnn_module PRIVATE ${DEPENDENCY_LIBS})
